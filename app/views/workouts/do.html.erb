<%= javascript_include_tag "jquery-2.1.1.min.js" %>
<%= javascript_include_tag "jquery-ui.min.js" %>
<%= javascript_include_tag "color.js" %>
<%= stylesheet_link_tag "excersise_do.css" %>
<%= stylesheet_link_tag "jquery-ui.css" %>

<script>
var excersise_group_order = <%= @excersise_group_order.to_json %>;
var largest_group = <%= @largest_group %>;

$(function () {
	
	var max_range = largest_group;
	if( max_range < 10 ) max_range = 10;

	var i = 0;
	$("#excersises").children().each( function() {
		
		if( $(this).attr('id').indexOf("rest") == -1 )
		{
			var rgb = HSBtoRGB(excersise_group_order[i] * (100.0/max_range), 0.68, 0.66);
			$(this).animate({backgroundColor: "rgb(" + parseInt(rgb[0]) + ", " + parseInt(rgb[1]) + ", " + parseInt(rgb[2]) + ")"});

			i += 1;
		}
		});

	});

function toggle_sets(id)
{
	if( $("#excersise_" + id).width() == 350 )
	{
		$("#excersise_" + id).animate({width: "700px", height: (($("#excersise_sets_" + id).height() + 140) + "px")}, 200, function() {
				$("#excersise_sets_" + id).css({visibility: "visible"});
				});
	}
	else
	{
		$("#excersise_sets_" + id).css({visibility: "hidden"});
		$("#excersise_" + id).animate({width: "350px", height: "300px"}, 200);
	}
}

</script>

<div id="container">
	<div id="excersises">
		<% @last_group = @excersises[0].group %>
		<% @excersises.each do |excersise| %>
			<% if excersise.group != @last_group %>
			<div id="rest_<%= @last_excersise %>" class="rest">
				<div id="rest_group_<%= @last_group %>" class="rest_group">
					<%= @last_group %>
				</div>

				<div class="rest_text">
					Rest Now
				</div>
			</div>

			<% @last_group = excersise.group %>
			<% end %>

			<div id="excersise_<%= excersise.id %>" class="excersise">

			<div id="excersise_letter_<%= excersise.id %>" class="excersise_letter" onclick="toggle_sets(<%= excersise.id %>)">
				<%= excersise.name[0] %>
			</div>
			
			<div id="excersise_information_<%= excersise.id %>" class="excersise_information">
				<div id="excersise_name_<%= excersise.id %>" class="excersise_name">
					<%= excersise.name %>
				</div>

				<div id="excersise_usual_<%= excersise.id %>" class="excersise_usual">
					<%= "Usual set is #{excersise.reps} reps" %> <%= if excersise.excersisetype != 3 then; " at #{excersise.diffculty} #{excersise.get_units}"; end %>
				</div>
			</div>

			<div id="excersise_sets_<%= excersise.id %>" class="excersise_sets">

				<% (1..excersise.sets).each do |i| %>
				<div id="excersise_set_<%= excersise.id %>_<%= i %>" class="excersise_set">
						
					<div class="excersise_set_number">
						Set <%= i %>
					</div>

					<div id="excersise_set_reps_<%= excersise.id %>_<%= i %>" class="excersise_set_reps">

					</div>

					<div id="excersise_set_diffculty_<%= excersise.id %>_<%= i %>" class="excersise_set_diffculty">

					</div>

					<div class="excersise_set_diffculty_units">
						<%= excersise.get_units %>
					</div>
				</div>
				<% end %>
			</div>
		</div>
		<% end %>
		
		<div id="rest_done" class="rest">
			<div id="rest_group_done" class="rest_group">
				D
			</div>

			<div class="rest_text">
				Workout Done
			</div>
		</div>

	</div>
</div>
